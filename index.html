<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cricket Quiz Bet</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://fonts.googleapis.com/css?family=Inter:400,600,700&display=swap" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
  <style>
    :root {
      --primary: #27b0f7;
      --primary-dark: #1651d8;
      --accent: #00c6ad;
      --bg: #f6fbff;
      --surface: #fff;
      --card-radius: 20px;
      --shadow: 0 10px 34px -8px #1895a622;
      --gradient: linear-gradient(93deg,#1bace7 52%, #12dca1 110%);
    }
    body {background: var(--bg);font-family: 'Inter', Arial, sans-serif;margin: 0;}
    #newsBar{background:#ffe658;color:#1a2471;font-weight:600;font-size:1em;padding:7px 0;text-align:center;}
    #newsBar marquee{width:96%;display:inline-block;}
    #app-container {
      max-width:490px;margin:0 auto;min-height:100vh;
      background: var(--surface); border-radius:0 0 var(--card-radius) var(--card-radius);
      box-shadow:0 10px 34px -8px #1895a622;
      overflow-x:hidden;
    }
    #topbar {
      display:flex;align-items:center;justify-content:space-between;
      height:62px; background: var(--gradient); color: #fff; font-weight:700;
      padding:0 20px; position:sticky; top:0; z-index:100;
    }
    #logo { font-size:1.1em; }
    #topbar .right { display:flex; gap:10px; }
    #profileBtn, #signOutBtn {
      background:rgba(255,255,255,0.25); border:none; color:#fff;
      padding:6px 12px; border-radius:20px; cursor:pointer; font-size:0.85em;
      transition:all 0.2s; font-weight:600;
    }
    #profileBtn:hover, #signOutBtn:hover {
      background:rgba(255,255,255,0.4); transform:scale(1.05);
    }
    
    .modal {
      position:fixed; top:0; left:0; width:100vw; height:100vh;
      background:rgba(0,0,0,0.6); display:none; align-items:center;
      justify-content:center; z-index:1000; backdrop-filter:blur(5px);
    }
    .modal-content {
      background:#fff; width:90%; max-width:400px; border-radius:var(--card-radius);
      padding:24px; position:relative; max-height:85vh; overflow-y:auto;
      box-shadow:0 20px 60px rgba(0,0,0,0.3);
    }
    .close-btn {
      position:absolute; top:15px; right:15px; background:none;
      border:none; font-size:24px; cursor:pointer; color:#999;
      transition:color 0.2s;
    }
    .close-btn:hover { color:#000; }
    
    .stats-grid {
      display:flex; justify-content:space-between; padding:20px;
      background:rgba(255,255,255,0.9); margin:10px; border-radius:15px;
    }
    .stat-item { text-align:center; }
    .stat-value { font-size:1.4em; font-weight:700; color:var(--primary); }
    .stat-label { font-size:0.85em; color:#666; margin-top:2px; }
    
    .action-buttons {
      display:flex; gap:10px; padding:0 20px 20px; justify-content:center;
    }
    .action-btn {
      background:var(--primary); color:#fff; border:none; padding:10px 20px;
      border-radius:25px; cursor:pointer; font-weight:600; font-size:0.9em;
      transition:all 0.2s; flex:1; max-width:120px;
    }
    .action-btn:hover { background:var(--primary-dark); transform:translateY(-1px); }
    .action-btn.wdr { background:var(--accent); }
    .action-btn.wdr:hover { background:#00a891; }
    
    .input-field {
      width:100%; padding:12px; border:2px solid #e5e5e5; border-radius:8px;
      font-size:1em; margin-bottom:15px; transition:border-color 0.2s;
    }
    .input-field:focus { outline:none; border-color:var(--primary); }
    
    .captcha-row {
      display:flex; align-items:center; gap:10px; margin-bottom:15px;
    }
    .captcha-display {
      background:linear-gradient(135deg,#e3f2fd,#bbdefb); color:var(--primary-dark);
      padding:8px 16px; border-radius:8px; font-family:monospace; font-weight:700;
      font-size:1.1em; letter-spacing:2px; user-select:none; border:2px solid var(--primary);
    }
    .refresh-captcha {
      background:var(--accent); color:#fff; border:none; padding:8px 12px;
      border-radius:6px; cursor:pointer; font-weight:700;
    }
    
    #mainContent { padding:10px; }
    .category-tabs {
      display:flex; overflow-x:auto; gap:8px; padding:10px 0;
      scrollbar-width:none; -ms-overflow-style:none;
    }
    .category-tabs::-webkit-scrollbar { display:none; }
    .category-tab {
      background:rgba(39,176,247,0.1); color:var(--primary); border:2px solid var(--primary);
      padding:8px 16px; border-radius:20px; cursor:pointer; font-weight:600;
      white-space:nowrap; transition:all 0.2s; font-size:0.85em;
    }
    .category-tab.active, .category-tab:hover {
      background:var(--primary); color:#fff;
    }
    
    .question-card {
      background:#fff; border-radius:var(--card-radius); padding:20px;
      margin:15px 0; box-shadow:var(--shadow); border-left:4px solid var(--primary);
    }
    .question-title { font-size:1.1em; font-weight:700; color:var(--primary-dark); margin-bottom:8px; }
    .question-category {
      background:var(--primary); color:#fff; padding:4px 12px;
      border-radius:15px; font-size:0.8em; display:inline-block; margin-bottom:10px;
    }
    .question-text { color:#555; line-height:1.5; margin-bottom:15px; }
    .question-timer {
      color:#ff6b35; font-weight:600; font-size:0.9em; margin-bottom:15px;
    }
    
    .bet-section {
      background:rgba(39,176,247,0.05); padding:20px; border-radius:15px;
      border:2px solid rgba(39,176,247,0.2); margin-top:15px;
    }
    
    .bet-choice-section {
      margin-bottom:20px;
    }
    
    .bet-choice-title {
      font-size:1em; font-weight:700; color:var(--primary-dark);
      margin-bottom:12px; text-align:center;
    }
    
    .bet-choices {
      display:flex; gap:10px; justify-content:center; margin-bottom:20px;
    }
    
    .bet-choice {
      flex:1; max-width:120px; padding:12px 16px; border:2px solid #e5e5e5;
      border-radius:12px; background:#fff; cursor:pointer; text-align:center;
      font-weight:600; transition:all 0.3s ease; position:relative;
    }
    
    .bet-choice:hover {
      border-color:var(--primary); transform:translateY(-2px);
      box-shadow:0 4px 15px rgba(39,176,247,0.2);
    }
    
    .bet-choice.selected {
      border-color:var(--primary); background:var(--primary); color:#fff;
      transform:translateY(-2px); box-shadow:0 4px 15px rgba(39,176,247,0.3);
    }
    
    .bet-choice.yes { border-color:#4caf50; }
    .bet-choice.yes:hover, .bet-choice.yes.selected { 
      border-color:#4caf50; background:#4caf50; 
    }
    
    .bet-choice.no { border-color:#f44336; }
    .bet-choice.no:hover, .bet-choice.no.selected { 
      border-color:#f44336; background:#f44336; 
    }
    
    .bet-amount-section {
      margin-top:15px;
    }
    
    .bet-amount-title {
      font-size:0.95em; font-weight:600; color:var(--primary-dark);
      margin-bottom:10px; text-align:center;
    }
    
    .bet-amounts {
      display:grid; grid-template-columns:repeat(auto-fit, minmax(140px, 1fr));
      gap:8px; margin-bottom:15px;
    }
    
    .bet-amount {
      padding:10px 12px; border:2px solid #e5e5e5; border-radius:10px;
      background:#fff; cursor:pointer; text-align:center; font-weight:600;
      font-size:0.85em; transition:all 0.3s ease; position:relative;
    }
    
    .bet-amount:hover {
      border-color:var(--primary); transform:translateY(-1px);
      box-shadow:0 2px 8px rgba(39,176,247,0.2);
    }
    
    .bet-amount.selected {
      border-color:var(--primary); background:var(--primary); color:#fff;
      transform:translateY(-1px); box-shadow:0 2px 8px rgba(39,176,247,0.3);
    }
    
    .bet-amount .amount { font-size:0.9em; font-weight:700; }
    .bet-amount .win { font-size:0.75em; color:#4caf50; margin-top:2px; }
    .bet-amount.selected .win { color:#90EE90; }
    
    .place-bet-btn {
      width:100%; background:var(--primary); color:#fff; border:none;
      padding:15px; border-radius:12px; font-size:1em; font-weight:700;
      cursor:pointer; transition:all 0.3s ease; margin-top:15px;
    }
    
    .place-bet-btn:hover {
      background:var(--primary-dark); transform:translateY(-2px);
      box-shadow:0 4px 15px rgba(39,176,247,0.3);
    }
    
    .place-bet-btn:disabled {
      background:#ccc; cursor:not-allowed; transform:none;
      box-shadow:none;
    }
    
    .bet-info {
      background:#e8f5e8; color:#2e7d32; padding:15px; border-radius:12px;
      font-weight:600; border-left:4px solid #4caf50; text-align:center;
    }
    
    .result-chip {
      padding:8px 16px; border-radius:25px; font-weight:700; font-size:0.9em;
      display:inline-block; margin-top:10px;
    }
    .win-bg { background:#d4edda; color:#155724; }
    .lose-bg { background:#f8d7da; color:#721c24; }
    .pending-bg { background:#fff3cd; color:#856404; }
    
    .history-section { margin-top:20px; }
    .history-item {
      background:#fff; padding:15px; margin:10px 0; border-radius:12px;
      box-shadow:0 2px 10px rgba(0,0,0,0.08); border-left:4px solid var(--accent);
    }
    .history-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:8px; }
    .history-question { font-weight:600; color:var(--primary-dark); }
    .history-amount { font-weight:700; }
    .history-details { font-size:0.9em; color:#666; }
    
    .auth-container {
      max-width:380px; margin:60px auto; padding:20px;
    }
    .auth-card {
      background:#fff; padding:30px; border-radius:var(--card-radius);
      box-shadow:var(--shadow); text-align:center;
    }
    .auth-title {
      font-size:1.5em; font-weight:700; color:var(--primary-dark);
      margin-bottom:25px;
    }
    .auth-input {
      width:100%; padding:12px; border:2px solid #e5e5e5; border-radius:8px;
      font-size:1em; margin-bottom:15px; box-sizing:border-box;
    }
    .auth-input:focus { outline:none; border-color:var(--primary); }
    .auth-btn {
      width:100%; background:var(--primary); color:#fff; border:none;
      padding:12px; border-radius:8px; font-size:1em; font-weight:700;
      cursor:pointer; margin-bottom:10px; transition:background 0.2s;
    }
    .auth-btn:hover { background:var(--primary-dark); }
    .auth-link { margin-top:15px; font-size:0.9em; }
    .auth-link a { color:var(--primary); text-decoration:none; font-weight:600; }
    
    .empty-state {
      text-align:center; padding:40px 20px; color:#666;
    }
    .empty-icon { font-size:3em; margin-bottom:15px; opacity:0.5; }
    
    @media (max-width: 500px) {
      #app-container { max-width:100%; border-radius:0; }
      .stats-grid { margin:5px; padding:15px; }
      .action-buttons { padding:0 15px 15px; }
      .question-card { margin:10px 5px; padding:15px; }
      .bet-choices { flex-direction:column; align-items:center; }
      .bet-choice { max-width:200px; }
      .bet-amounts { grid-template-columns:repeat(2, 1fr); }
    }
  </style>
</head>
<body>
  <div id="newsBar">
    <marquee id="newsText">Welcome to Cricket Quiz Bet! Place your bets and win big!</marquee>
  </div>

  <div id="authContainer" class="auth-container" style="display:none;"></div>

  <div id="app-container" style="display:none;">
    <div id="topbar">
      <div id="logo">🏏 Cricket Quiz Bet</div>
      <div class="right">
        <button id="profileBtn" onclick="openProfile()">Profile</button>
        <button id="signOutBtn" onclick="signOut()">Sign Out</button>
      </div>
    </div>

    <div class="stats-grid">
      <div class="stat-item">
        <div class="stat-value" id="walletAmount">₹0</div>
        <div class="stat-label">Wallet</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="totalBets">0</div>
        <div class="stat-label">Total Bets</div>
      </div>
      <div class="stat-item">
        <div class="stat-value" id="totalWins">0</div>
        <div class="stat-label">Wins</div>
      </div>
    </div>

    <!-- Profile Modal -->
    <div id="profileModal" class="modal">
      <div class="modal-content">
        <button class="close-btn" onclick="closeProfile()">×</button>
        <h3>👤 Profile</h3>
        <div id="profileContent">Loading...</div>
      </div>
    </div>

    <div class="action-buttons">
      <button class="action-btn" onclick="openDeposit()">Deposit</button>
      <button class="action-btn wdr" onclick="openWithdraw()">Withdraw</button>
    </div>

    <!-- Deposit Modal -->
    <div id="depositModal" class="modal">
      <div class="modal-content">
        <button class="close-btn" onclick="closeDeposit()">×</button>
        <h3>💰 Deposit Money</h3>
        <p style="color:#666;font-size:0.9em;margin-bottom:15px;">
          Send money to UPI: <strong>your-upi@paytm</strong><br>
          Then fill this form with transaction details
        </p>
        <input type="number" id="depositAmount" class="input-field" placeholder="Amount (min ₹100)" min="100">
        <input type="text" id="depositName" class="input-field" placeholder="Your Full Name" required>
        <input type="tel" id="depositPhone" class="input-field" placeholder="Phone Number" maxlength="10">
        <input type="text" id="depositTxnId" class="input-field" placeholder="UPI Transaction ID">
        <div class="captcha-row">
          <div class="captcha-display" id="depositCaptcha">LOADING</div>
          <button class="refresh-captcha" onclick="refreshDepositCaptcha()" type="button">↻</button>
          <input type="text" id="depositCaptchaInput" class="input-field" placeholder="Enter Captcha" style="margin-bottom:0;flex:1;">
        </div>
        <button class="action-btn" style="width:98%;margin-top:10px;" onclick="submitDeposit()">Submit</button>
      </div>
    </div>

    <!-- Withdraw Modal -->
    <div id="withdrawModal" class="modal">
      <div class="modal-content">
        <button class="close-btn" onclick="closeWithdraw()">×</button>
        <h3>💸 Withdraw Money</h3>
        <input type="number" id="withdrawAmount" class="input-field" placeholder="Amount (min ₹100)" min="100">
        <input type="text" id="withdrawAccount" class="input-field" placeholder="Bank Account Number" required>
        <input type="text" id="withdrawIFSC" class="input-field" placeholder="IFSC Code" required>
        <div class="captcha-row">
          <div class="captcha-display" id="withdrawCaptcha">LOADING</div>
          <button class="refresh-captcha" onclick="refreshWithdrawCaptcha()" type="button">↻</button>
          <input type="text" id="withdrawCaptchaInput" class="input-field" placeholder="Enter Captcha" style="margin-bottom:0;flex:1;">
        </div>
        <button class="action-btn wdr" style="width:98%;margin-top:10px;" onclick="submitWithdraw()">Request Withdraw</button>
      </div>
    </div>

    <div id="mainContent">
      <div class="category-tabs" id="categoryTabs">
        <div class="category-tab active" onclick="filterByCategory('All')">All</div>
        <div class="category-tab" onclick="filterByCategory('IPL')">IPL</div>
        <div class="category-tab" onclick="filterByCategory('ODI')">ODI</div>
        <div class="category-tab" onclick="filterByCategory('T20')">T20</div>
        <div class="category-tab" onclick="filterByCategory('Test')">Test</div>
      </div>
      
      <div id="questionsContainer">
        <div class="empty-state">
          <div class="empty-icon">🔄</div>
          <div>Loading cricket betting opportunities...</div>
        </div>
      </div>
      
      <div class="history-section">
        <h3 style="padding:0 10px;color:var(--primary-dark);">📊 Recent Bets</h3>
        <div id="historyContainer">
          <div class="empty-state">
            <div class="empty-icon">📋</div>
            <div>No betting history yet</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDV8nNFUsRWZvwE5hSC0fQAEjtLKPtIDPo",
      authDomain: "pdf-hosting-54a2f.firebaseapp.com",
      databaseURL: "https://pdf-hosting-54a2f-default-rtdb.firebaseio.com",
      projectId: "pdf-hosting-54a2f",
      storageBucket: "pdf-hosting-54a2f.appspot.com",
      messagingSenderId: "276398225231",
      appId: "1:276398225231:web:65b9ac0f9db22ed56976b7"
    };
    firebase.initializeApp(firebaseConfig);

    // **UPDATED BETTING PAYOUTS WITH NEW AMOUNTS**
    const BET_PAYOUTS = {
      20: 10,
      40: 20, 
      60: 30,
      100: 70,
      150: 100,    // NEW: ₹150 to win ₹100
      250: 150,    // NEW: ₹250 to win ₹150
      500: 250,    // NEW: ₹500 to win ₹250
      1000: 400    // NEW: ₹1000 to win ₹400
    };
    
    const CATEGORY_LIST = ["All","IPL","ODI","T20","Test"];
    let curUser = null, curSafeEmail = '', uStats={}, allQuestions={}, shownCategory='All', liveMatches={};

    firebase.auth().onAuthStateChanged(user => {
      if (user) {
        curUser = user;
        curSafeEmail = user.email.replace(/[.#$[\]]/g, '_');
        document.getElementById('authContainer').style.display = 'none';
        document.getElementById('app-container').style.display = 'block';
        loadUserStats();
        loadQuestions();
        loadNews();
      } else {
        document.getElementById('authContainer').style.display = 'block';
        document.getElementById('app-container').style.display = 'none';
        renderAuthPage('login');
      }
    });

    function renderAuthPage(page) {
      let content = '';
      if (page === 'login') {
        content = `
          <div class="auth-card">
            <h2 class="auth-title">🏏 Login to Cricket Bet</h2>
            <input type="email" id="loginEmail" class="auth-input" placeholder="Email">
            <input type="password" id="loginPassword" class="auth-input" placeholder="Password">
            <button class="auth-btn" onclick="doLogin()">Login</button>
            <div class="auth-link"><a href="#" onclick="renderAuthPage('signup')">Create Account</a></div>
            <div class="auth-link"><a href="#" onclick="renderAuthPage('forgot')">Forgot Password?</a></div>
          </div>
        `;
      } else if (page === 'signup') {
        content = `
          <div class="auth-card">
            <h2 class="auth-title">📝 Create Account</h2>
            <input type="email" id="signupEmail" class="auth-input" placeholder="Email">
            <input type="password" id="signupPassword" class="auth-input" placeholder="Password">
            <input type="password" id="confirmPassword" class="auth-input" placeholder="Confirm Password">
            <button class="auth-btn" onclick="doSignup()">Create Account</button>
            <div class="auth-link"><a href="#" onclick="renderAuthPage('login')">Already have account?</a></div>
          </div>
        `;
      } else if (page === 'forgot') {
        content = `
          <div class="auth-card">
            <h2 class="auth-title">🔐 Reset Password</h2>
            <input type="email" id="resetEmail" class="auth-input" placeholder="Enter your email">
            <button class="auth-btn" onclick="doPasswordReset()">Send Reset Email</button>
            <div class="auth-link"><a href="#" onclick="renderAuthPage('login')">Back to Login</a></div>
          </div>
        `;
      }
      document.getElementById('authContainer').innerHTML = content;
    }

    function doLogin() {
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;
      if (!email || !password) return alert('Please fill all fields');
      
      firebase.auth().signInWithEmailAndPassword(email, password)
        .catch(error => alert('Login failed: ' + error.message));
    }

    function doSignup() {
      const email = document.getElementById
